{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Parameters": {
        "CodePipelineServiceRole": {
            "Type": "String"
        },
        "SourceS3Bucket": {
            "Type": "String"
        },
        "SourceS3ObjectKey": {
            "Type": "String"
        },
        "ApplicationName": {
            "Type": "String"
        },
        "DeploymentGroupName": {
            "Type": "String"
        },
        "ArtifactstoreS3Location": {
            "Type": "String"
        }
    },
    "Resources": {
		"pipeline": {
            "Type": "AWS::CodePipeline::Pipeline",
            "Properties": {
				"Name": "test",
				"RoleArn": "arn:aws:iam::756258835214:role/AWSCodePipelineFullAccess",
				"ArtifactStore": {
					"Type": "S3",
					"Location": "codepipeline-1234567890"
				},
				"Stages": [
					{
						"Name": "Source",
						"Actions": [
							{
								"Name": "Source",
								"ActionTypeId": {
									"Category": "Source",
									"Owner": "ThirdParty",
									"Provider": "GitHub",
									"Version": "1"
								},
								"RunOrder": 1,
								"Configuration": {
									"Branch": "master",
									"OAuthToken": "cfc1a91beba3bfe051ffec2bbe356d5e517aa535",
									"Owner": "CrazyDoc",
									"PollForSourceChanges": "false",
									"Repo": "infrastructure-beanstalk-test"
								},
								"OutputArtifacts": [
									{
										"Name": "SourceArtifact"
									}
								],
								"InputArtifacts": [],
								"Region": "us-east-2"
							}
						]
					},
					{
						"Name": "Build",
						"Actions": [
							{
								"Name": "Build",
								"ActionTypeId": {
									"Category": "Build",
									"Owner": "AWS",
									"Provider": "CodeBuild",
									"Version": "1"
								},
								"RunOrder": 1,
								"Configuration": {
									"ProjectName": "test"
								},
								"OutputArtifacts": [
									{
										"Name": "BuildArtifact"
									}
								],
								"InputArtifacts": [
									{
										"Name": "SourceArtifact"
									}
								],
								"Region": "us-east-2"
							}
						]
					},
					{
						"Name": "Deploy",
						"Actions": [
							{
								"Name": "Deploy",
								"ActionTypeId": {
									"Category": "Deploy",
									"Owner": "AWS",
									"Provider": "ElasticBeanstalk",
									"Version": "1"
								},
								"RunOrder": 1,
								"Configuration": {
									"ApplicationName": "test",
									"EnvironmentName": "test-env"
								},
								"OutputArtifacts": [],
								"InputArtifacts": [
									{
										"Name": "BuildArtifact"
									}
								],
								"Region": "us-east-2"
							}
						]
					}
				]
			}
		},
		"codebuild": {
			"Type": "AWS::CodeBuild::Project",
			"Properties": {
				"Name": "test",
				"Source": {
					"Type": "CODEPIPELINE",
					"InsecureSsl": false
				},
				"Artifacts": {
					"Type": "CODEPIPELINE",
					"Name": "test",
					"Packaging": "NONE",
					"EncryptionDisabled": false
				},
				"Cache": {
					"Type": "NO_CACHE"
				},
				"Environment": {
					"Type": "LINUX_CONTAINER",
					"Image": "aws/codebuild/java:openjdk-11",
					"ComputeType": "BUILD_GENERAL1_SMALL",
					"EnvironmentVariables": [],
					"PrivilegedMode": false,
					"ImagePullCredentialsType": "CODEBUILD"
				},
				"ServiceRole": "arn:aws:iam::756258835214:role/AWSCodeBuildAdminAccess",
				"TimeoutInMinutes": 60,
				"QueuedTimeoutInMinutes": 480,
				"Tags": [],
				"LogsConfig": {
					"CloudWatchLogs": {
						"Status": "ENABLED"
					},
					"S3Logs": {
						"Status": "DISABLED",
						"EncryptionDisabled": false
					}
				}
			}
		}
	}
}